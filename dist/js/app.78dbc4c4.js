(function(e){function t(t){for(var a,r,s=t[0],c=t[1],u=t[2],l=0,d=[];l<s.length;l++)r=s[l],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);p&&p(t);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,r=1;r<n.length;r++){var s=n[r];0!==i[s]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},r={app:0},i={app:0},o=[];function s(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-80cb6d7c":"1e5e21c6"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-80cb6d7c":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-80cb6d7c":"d677c9dc"}[e]+".css",i=c.p+a,o=document.getElementsByTagName("link"),s=0;s<o.length;s++){var u=o[s],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===a||l===i))return t()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){u=d[s],l=u.getAttribute("data-href");if(l===a||l===i)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var a=t&&t.target&&t.target.src||i,o=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=a,delete r[e],p.parentNode.removeChild(p),n(o)},p.href=i;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){r[e]=0})));var a=i[e];if(0!==a)if(a)t.push(a[2]);else{var o=new Promise((function(t,n){a=i[e]=[t,n]}));t.push(a[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=s(e);var d=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(p);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",d.name="ChunkLoadError",d.type=a,d.request=r,n[1](d)}i[e]=void 0}};var p=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var d=0;d<u.length;d++)t(u[d]);var p=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"159b7":function(e,t,n){},"21bb":function(e,t,n){"use strict";n("2dad")},2226:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["helper",e.inGame?"in-game":""].concat(e.helperClass)},[e._l(e.helperLinks,(function(t){return n("div",{key:t.code,class:["helper-link","helper-avatar",t.customClass],style:{left:t.clientRect.left+(t.pos.left?0:t.clientRect.width)+"px",top:t.clientRect.top+(t.pos.top?0:t.clientRect.height)+"px"},on:{click:function(n){return n.stopPropagation(),e.showTutorial(t)}}})})),e.menu?e._e():n("div",{class:["helper-guru","helper-avatar","scale-"+e.guiScale],on:{click:function(t){return t.stopPropagation(),e.initMenu.apply(null,arguments)}}}),e.menu?n("div",{class:["helper-menu","scale-"+e.guiScale]},[n("div",{staticClass:"helper-avatar"}),n("div",{staticClass:"content"},[n("div",{staticClass:"text"},[e._v(" "+e._s(e.menu.text)+" ")]),e.menu.showTutorials&&e.inGame?n("ul",{staticClass:"tutorials"},[n("li",{on:{click:function(t){return t.stopPropagation(),e.action({tutorial:"tutorialGameStart"})}}},[e._v("Стартовое приветствие игры")])]):e._e(),e.menu.showTutorials&&!e.inGame?n("ul",{staticClass:"tutorials"},[n("li",{on:{click:function(t){return t.stopPropagation(),e.action({tutorial:"tutorialLobbyStart"})}}},[e._v("Стартовое приветствие")])]):e._e(),e.menu.buttons?n("div",{class:["controls",e.menu.bigControls?"big":""]},e._l(e.menu.buttons,(function(t){return n("button",{key:t.text,on:{click:function(n){return n.stopPropagation(),e.menuAction({action:t.action})}}},[e._v(" "+e._s(t.text)+" "),t.exit?n("font-awesome-icon",{staticStyle:{color:"#f4e205"},attrs:{icon:["far","circle-xmark"],size:"lg"}}):e._e(),"leaveGame"===t.action?n("font-awesome-icon",{staticStyle:{color:"#f4e205"},attrs:{icon:["fas","right-from-bracket"],size:"lg"}}):e._e()],1)})),0):e._e()])]):e._e(),n("div",{class:["helper-dialog","scale-"+e.guiScale].concat(e.dialogClass),style:e.dialogStyle},[n("div",{staticClass:"helper-avatar"}),n("div",{staticClass:"content"},[e.helperData.img?n("div",{staticClass:"img"},[n("img",{attrs:{src:e.helperData.img}})]):e._e(),n("div",{staticClass:"text"},[e._v(" "+e._s(e.helperData.text)+" ")]),n("div",{staticClass:"video"}),e.helperData.buttons?n("div",{staticClass:"controls"},e._l(e.helperData.buttons,(function(t){return n("button",{key:t.text,on:{click:function(n){return n.stopPropagation(),e.action(Object.assign({},t))}}},[e._v(" "+e._s(t.text)+" "),t.exit?n("div",{staticClass:"exit-icon"}):e._e()])})),0):e._e()])])],2)},r=[],i=n("1da1"),o=n("3835"),s=n("5530"),c=(n("96cf"),n("4de4"),n("d81d"),n("4fad"),n("caad"),n("2532"),n("ac1f"),n("1276"),n("a15b"),n("159b"),n("9911"),n("2f62")),u={name:"helper",components:{},props:{inGame:Boolean},data:function(){return{menu:null,dialogActive:!1,helperClassMap:{},dialogStyle:{},dialogClassMap:{}}},watch:{helperData:function(){this.update()}},computed:Object(s["a"])(Object(s["a"])({},Object(c["b"])({getStore:"getStore",currentUser:"currentUser",guiScale:"guiScale",getHelperLinks:"getHelperLinks",helperLinksBounds:"helperLinksBounds"})),{},{helperData:function(){return this.getStore(this.currentUser,"user").helper||{}},helperLinks:function(){var e=this;return Object.entries(this.getHelperLinks).map((function(t){var n=Object(o["a"])(t,2),a=n[0],r=n[1];return Object(s["a"])(Object(s["a"])({code:a,pos:{}},r),{},{clientRect:e.helperLinksBounds[a]})})).filter((function(e){var t=e.clientRect;return t}))},helperClass:function(){return Object.entries(this.helperClassMap).filter((function(e){var t=Object(o["a"])(e,2),n=(t[0],t[1]);return n})).map((function(e){var t=Object(o["a"])(e,1),n=t[0];return n}))},dialogClass:function(){return Object.entries(this.dialogClassMap).filter((function(e){var t=Object(o["a"])(e,2),n=(t[0],t[1]);return n})).map((function(e){var t=Object(o["a"])(e,1),n=t[0];return n}))},menuData:function(){return this.helperData.menu||null}}),methods:{update:function(){var e=this,t=this.helperData,n=t.text,a=t.img,r=t.active,i=t.pos,o=void 0===i?"bottom-right":i,s=t.fullscreen,c=void 0!==s&&s;this.$set(this.helperClassMap,"dialog-active",!(!n&&!a)),this.$set(this.helperClassMap,"fullscreen",c);var u={},l="20px";if(c?o.includes("top")&&Object.assign(u,{top:l,left:l,width:"100%",height:"100%"}):(o=o.split("-"),o.includes("top")&&Object.assign(u,{top:l,bottom:"auto"}),o.includes("bottom")&&Object.assign(u,{bottom:l,top:"auto"}),o.includes("left")&&Object.assign(u,{left:l,right:"auto"}),o.includes("right")&&Object.assign(u,{right:l,left:"auto"}),u["transform-origin"]=o.join(" ")),this.dialogStyle=u,document.querySelectorAll(".tutorial-active").forEach((function(e){e.classList.remove("tutorial-active")})),r){"string"===typeof r&&(r={selector:r});var d=r,p=d.selector,f=d.update,v=d.customClass;document.querySelectorAll(p).forEach((function(t){t&&(t.classList.add("tutorial-active"),v&&t.classList.add(v),f&&t.addEventListener("click",(function(){e.action(f)})))}))}},action:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r,i,o,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.action,r=e.step,i=e.tutorial,o=e.link,!o){n.next=10;break}s=document.createElement("a"),s.style.display="none",s.href=o,s.target="_blank",document.body.appendChild(s),s.click(),n.next=13;break;case 10:return n.next=12,api.helper.action({action:a,step:r,tutorial:i});case 12:i&&(t.menu=null);case 13:case"end":return n.stop()}}),n)})))()},initMenu:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.inGame?e.menu={text:"Чем могу помочь?",bigControls:!0,buttons:[{text:"Спасибо, ничего не нужно",action:"exit",exit:!0},{text:"Покажи доступные обучения",action:"tutorials"},{text:"Закончить игру",action:"leaveGame"}]}:e.menu={text:"Чем могу помочь?",bigControls:!0,buttons:[{text:"Спасибо, ничего не нужно",action:"exit",exit:!0},{text:"Покажи доступные обучения",action:"tutorials"}]};case 1:case"end":return t.stop()}}),t)})))()},menuAction:function(e){var t=e.action;switch(t){case"exit":this.menu=null;break;case"init":this.initMenu();break;case"tutorials":this.menu={text:"Выберите на нужное обучение, чтобы запустить его повторно:",showTutorials:!0,buttons:[{text:"Назад в меню",action:"init"},{text:"Спасибо",action:"exit",exit:!0}]};break;case"leaveGame":api.lobby.leaveGame().catch((function(e){console.log({err:e}),alert(e.message)}));break}},showTutorial:function(e){var t=e.tutorial,n=e.code;t&&api.helper.action({tutorial:t,usedLink:n})}},mounted:function(){this.$nextTick(this.update)}},l=u,d=(n("4e8f"),n("2877")),p=Object(d["a"])(l,a,r,!1,null,null,null);t["a"]=p.exports},"2dad":function(e,t,n){},"4e8f":function(e,t,n){"use strict";n("159b7")},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("3835"),r=n("b85c"),i=n("1da1"),o=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("96cf"),n("99af"),n("b0c0"),n("ac1f"),n("466d"),n("c1f9"),n("d81d"),n("4fad"),n("2b0e")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},c=[],u=(n("5c0b"),n("2877")),l={},d=Object(u["a"])(l,s,c,!1,null,null,null),p=d.exports,f=(n("d3b7"),n("3ca3"),n("ddb0"),n("8c4f")),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:[e.isMobile?"mobile-view":"",e.isLandscape?"landscape-view":"portrait-view"],attrs:{id:"lobby"}},[a("tutorial"),a("div",{class:["menu-item","info",e.isMobile?"":"pinned"]},[a("label",{on:{click:e.pinMenuItem}},[e._v(" УСЛУГИ СТУДИИ "),a("font-awesome-icon",{staticClass:"fa-xs",attrs:{icon:"fa-solid fa-thumbtack"}})],1),a("div",[a("ul",[a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showInfo("games")}}},[e._v("Разработка игр на заказ")]),a("div",[e._v("Настольные обучающие игры для любой сферы бизнеса")])]),a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showInfo("it")}}},[e._v("Создание онлайн-версий игр")]),a("div",[e._v("Собственная команда программистов")])]),a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showInfo("contacts")}}},[e._v("Связаться с нами")]),a("div",[e._v("Контактная информация")])])])])]),a("div",{staticClass:"menu-item game"},[a("label",{on:{click:e.pinMenuItem}},[e._v(" ИГРОВАЯ КОМНАТА "),a("font-awesome-icon",{staticClass:"fa-xs",attrs:{icon:"fa-solid fa-thumbtack"}})],1),a("div",[a("div",{staticClass:"new-game-btn-list"},[a("div",{on:{click:function(t){return e.addGame("single-blitz")}}},[a("font-awesome-icon",{attrs:{icon:["fas","user"],size:"2xl"}}),e._v(" Фриланс ")],1),a("div",{on:{click:function(t){return e.addGame("duel-blitz")}}},[a("font-awesome-icon",{attrs:{icon:["fas","user-group"],size:"2xl"}}),e._v(" Дуэль ")],1),a("div",{on:{click:function(t){return e.addGame("ffa-blitz")}}},[a("font-awesome-icon",{attrs:{icon:["fas","users"],size:"2xl"}}),e._v(" Каждый за себя ")],1),a("div",{staticClass:"disabled"},[a("font-awesome-icon",{staticStyle:{color:"#fff"},attrs:{icon:["fas","dice-four"],size:"2xl"}}),e._v(" Команды ")],1)]),a("hr",{style:{margin:"10px 30px",borderColor:"#f4e205"}}),e._l(e.gameList,(function(t){return a("div",{key:t._id},[e._v(" Раунд: ( "+e._s(t.round)+" ) Набрано игроков: ( "+e._s(t.joinedPlayers)+" ) "),a("button",{staticClass:"lobby-btn",on:{click:function(n){return e.joinGame({gameId:t._id})}}},[e._v("Присоединиться к игре")])])}))],2)]),a("div",{staticClass:"menu-item list"},[a("label",{on:{click:e.pinMenuItem}},[e._v(" ПРАВИЛА ИГР "),a("font-awesome-icon",{staticClass:"fa-xs",attrs:{icon:"fa-solid fa-thumbtack"}})],1),a("div",[a("ul",[a("li",{staticClass:"disabled"},[a("label",{staticClass:"not-disabled"},[e._v('Игра "Релиз"')]),a("div",[e._v("Игра про ИТ-разработку")]),a("ul",[a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showRules("release")}}},[e._v("Правила игры")]),a("hr"),a("span",{on:{click:function(t){return e.showGallery("release")}}},[e._v("Список карт")])])])]),a("li",{staticClass:"disabled"},[a("label",[e._v("Автобизнес")]),a("div",[e._v("Колода для игр про продажи автомобилей")]),a("ul",[a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showRules("auto-deck")}}},[e._v("Описание колоды")]),a("hr"),a("span",{on:{click:function(t){return e.showGallery("auto","car")}}},[e._v("Карты авто")]),a("br"),a("span",{on:{click:function(t){return e.showGallery("auto","service")}}},[e._v("Карты сервисов")]),a("br"),a("span",{on:{click:function(t){return e.showGallery("auto","client")}}},[e._v("Карты клиентов")]),a("br"),a("span",{on:{click:function(t){return e.showGallery("auto","spec")}}},[e._v("Карты особенностей")]),a("br")]),a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showRules("auto-sales")}}},[e._v('Игра "Авто-продажи"')])]),a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showRules("auto-auction")}}},[e._v('Игра "Авто-аукцион"')])]),a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showRules("auto-express")}}},[e._v('Игра "Авто-экспресс"')])])])]),a("li",{staticClass:"disabled"},[a("label",[e._v("Скорринг")]),a("div",[e._v("Колода для игр про работу в банках")]),a("ul",[a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showRules("bank-deck")}}},[e._v("Описание колоды")]),a("hr"),a("span",{on:{click:function(t){return e.showGallery("bank","product")}}},[e._v("Карты продуктов")]),a("br"),a("span",{on:{click:function(t){return e.showGallery("bank","service")}}},[e._v("Карты сервисов")]),a("br"),a("span",{on:{click:function(t){return e.showGallery("bank","scoring")}}},[e._v("Карты скоринга")]),a("br"),a("span",{on:{click:function(t){return e.showGallery("bank","client")}}},[e._v("Карты клиентов")]),a("br"),a("span",{on:{click:function(t){return e.showGallery("bank","spec")}}},[e._v("Карты особенностей")]),a("br")]),a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showRules("bank-sales")}}},[e._v('Игра "Банк-продаж"')])]),a("li",[a("label",{on:{click:function(t){return t.stopPropagation(),e.showRules("bank-risks")}}},[e._v('Игра "Банк-рисков"')])])])])])])]),a("div",{staticClass:"menu-item chat"},[a("label",{on:{click:e.pinMenuItem}},[e._v(" ОБЩЕНИЕ "),a("font-awesome-icon",{staticClass:"fa-xs",attrs:{icon:"fa-solid fa-thumbtack"}})],1),a("div",{style:{display:"flex",flexWrap:"wrap",overflow:"hidden"}},[a("div",{staticClass:"user-list",style:{width:"100%",display:"flex",flexWrap:"wrap",borderBottom:"2px solid #f4e205",padding:"10px"}},[a("label",{staticClass:"user-list-label",style:{width:"100%"}},[e._v("Игроки онлайн ("+e._s(e.userList.length)+")")]),a("div",{staticClass:"user-list"},e._l(e.userList,(function(t){return a("span",{key:t._id},[e._v(" "+e._s(t.name||"Гость")+" ")])})),0)]),a("div",{style:{height:"100%",width:"100%",display:"flex",flexWrap:"wrap",overflow:"hidden"}},[a("div",{staticClass:"msg-list",style:{paddingBottom:"80px",paddingTop:"10px",paddingLeft:"10px",paddingRight:"10px"}},e._l(e.getChat,(function(t){return a("div",{key:t._id,staticClass:"msg"},[a("div",{staticClass:"header"},[a("b",[e._v(e._s(t.user.name))]),a("i",[e._v(e._s(t.timeStr))])]),e._v(" "+e._s(t.text)+" ")])})),0)]),a("div",{staticClass:"chat-controls",style:{position:"absolute",width:"100%",display:"flex",left:"0px",bottom:"0px",boxShadow:"inset 0px -20px 20px 20px black"}},[e.userData.name?e._e():a("div",{style:{position:"absolute",width:"100%",height:"100%",left:"0px",top:"0px",background:"black",paddingTop:"10px",zIndex:"2"}},[a("div",{style:{padding:"8px"}},[e._v("Укажите свое имя, чтобы начать писать в чат")]),a("div",{style:{display:"flex",justifyContent:"space-evenly"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.userName,expression:"userName"}],style:{border:"1px solid #f4e205",background:"black",color:"white",padding:"4px 10px"},domProps:{value:e.userName},on:{input:function(t){t.target.composing||(e.userName=t.target.value)}}}),a("button",{staticClass:"lobby-btn",on:{click:e.saveName}},[e._v("Сохранить")])])]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.chatMsgText,expression:"chatMsgText"}],style:{width:"100%",background:"black",border:"1px solid #f4e205",resize:"none",color:"white",padding:"10px",margin:"10px",zIndex:"1"},attrs:{rows:"3"},domProps:{value:e.chatMsgText},on:{input:function(t){t.target.composing||(e.chatMsgText=t.target.value)}}}),e._v(" "),a("button",{staticClass:"lobby-btn",style:{color:"#ffffff",width:"40px",height:"40px",marginTop:"10px",marginRight:"10px",boxShadow:"black -10px 10px 20px 20px",zIndex:"0"},attrs:{disabled:e.disableSendMsgBtn>0},on:{click:e.sendChatMsg}},[e.disableSendMsgBtn>0?a("span",[e._v(" "+e._s(e.disableSendMsgBtn)+" ")]):e._e(),0===e.disableSendMsgBtn?a("font-awesome-icon",{attrs:{icon:["fas","share"]}}):e._e()],1)])])]),a("div",{staticClass:"menu-item top"},[a("label",{on:{click:e.pinMenuItem}},[e._v(" ЗАЛ СЛАВЫ "),a("font-awesome-icon",{staticClass:"fa-xs",attrs:{icon:"fa-solid fa-thumbtack"}})],1),a("div",[e._v(" раздел в разработке ")])]),a("img",{style:{position:"absolute",left:(e.bg.left||0)+"px",top:(e.bg.top||0)+"px",scale:e.bg.scale||1,transformOrigin:"center",filter:"grayscale(1)"},attrs:{id:"bg-img",src:n("9e6d"),usemap:"#image-map"}})],1)},h=[],m=n("5530"),b=(n("b64b"),n("4de4"),n("07ac"),n("2f62")),g=n("8563"),w=(n("1393"),n("2226")),k={components:{tutorial:w["a"]},data:function(){return{userName:"",chatMsgText:"",disableSendMsgBtn:0,bg:{top:0,left:0,showMask:""}}},watch:{},computed:Object(m["a"])(Object(m["a"])({},Object(b["b"])({getStore:"getStore",isMobile:"isMobile",isLandscape:"isLandscape",currentUser:"currentUser"})),{},{userData:function(){return this.getStore(this.currentUser,"user")||{}},userList:function(){var e=this,t=Object.keys(this.lobby.userMap||{}).map((function(t){return e.getStore(t,"user")}))||[];return t.map((function(e){return e}))},lobby:function(){return this.getStore("main","lobby")||{}},gameList:function(){var e=this,t=Object.keys(this.lobby.gameMap||{}).map((function(t){return e.getStore(t,"game")}))||[];return t.map((function(e){return e.playerList&&(e.joinedPlayers=e.playerList.filter((function(e){return e.ready})).length+" из "+e.playerList.length),e}))},getChat:function(){var e=this.getStore("chat");return Object.values(e).map((function(e){return Object(m["a"])(Object(m["a"])({},e),{},{timeStr:new Date(e.time).toLocaleString()})})).reverse()},getTopPlayers:function(){return this.getStore("topPlayers")}}),methods:{show:function(e){""===e&&this.isMobile||(this.bg.showMask=e)},pinMenuItem:function(e){e.target.closest(".menu-item").classList.toggle("pinned")},addGame:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,api.lobby.newGame({type:e}).then((function(e){var n=e.gameId;n&&t.joinGame({gameId:n})}));case 2:case"end":return n.stop()}}),n)})))()},joinGame:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.gameId,t.next=3,api.lobby.joinGame({gameId:n});case 3:case"end":return t.stop()}}),t)})))()},deleteGame:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.gameId,t.next=3,api.lobby.deleteGame({gameId:n});case 3:case"end":return t.stop()}}),t)})))()},showInfo:function(e){api.helper.action({tutorial:"tutorialSales",step:e})},showRules:function(e){api.helper.action({tutorial:"tutorialGameRules",step:e})},saveName:function(){api.lobby.updateUser({userName:this.userName})},sendChatMsg:function(){var e=this;this.disableSendMsgBtn=5,api.lobby.updateChat({text:this.chatMsgText}).then((function(t){e.chatMsgText="",e.restoreMsgBtn()})).catch((function(t){e.restoreMsgBtn()}))},restoreMsgBtn:function(){this.disableSendMsgBtn>0&&(this.disableSendMsgBtn--,setTimeout(this.restoreMsgBtn,1e3))},showGallery:function(e,t){var n=[];switch(e){case"release":n=[{name:"audit"},{name:"claim"},{name:"coffee"},{name:"crutch"},{name:"crutch"},{name:"crutch"},{name:"disease"},{name:"dream"},{name:"emergency"},{name:"flowstate"},{name:"give_project"},{name:"insight"},{name:"lib"},{name:"pilot"},{name:"refactoring"},{name:"req_legal"},{name:"req_tax"},{name:"security"},{name:"showoff"},{name:"superman"},{name:"take_project"},{name:"teamlead"},{name:"transfer"},{name:"weekend"},{name:"water"}].map((function(e){var t=e.name;return"release/".concat(t,".jpg")})).filter((function(e,t,n){return n.indexOf(e)===t}));break;case"auto":switch(t){case"car":for(var a=1;a<=32;a++)n.push("auto/car/car (".concat(a,").png"));break;case"service":for(var r=1;r<=32;r++)n.push("auto/service/service (".concat(r,").png"));break;case"client":for(var i=1;i<=24;i++)n.push("auto/client/client (".concat(i,").png"));break;case"spec":for(var o=1;o<=24;o++)n.push("auto/spec/spec (".concat(o,").png"));break}break;case"bank":switch(t){case"product":for(var s=1;s<=32;s++)n.push("bank/product/product (".concat(s,").png"));break;case"service":for(var c=1;c<=32;c++)n.push("bank/service/service (".concat(c,").png"));break;case"client":for(var u=1;u<=24;u++)n.push("bank/client/client (".concat(u,").png"));break;case"spec":for(var l=1;l<=24;l++)n.push("bank/spec/spec (".concat(l,").png"));break;case"scoring":for(var d=1;d<=38;d++)n.push("bank/scoring/scoring (".concat(d,").png"));break}break}new g["a"](n.map((function(e){return{src:"/img/cards/".concat(e),type:"image"}})))}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.commit("setSimple",{store:{}});case 1:case"end":return t.stop()}}),t)})))()},mounted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=function(){var e=1024,t=2048;n.bg.top=window.innerHeight/2-e/2,n.bg.left=window.innerWidth/2-t/2,n.bg.scale=Math.max(window.innerHeight/e,window.innerWidth/t)},n=e,a(),window.addEventListener("resize",a),t.next=6,api.lobby.enter();case 6:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},y=k,x=(n("21bb"),Object(u["a"])(y,v,h,!1,null,null,null)),j=x.exports;o["a"].use(f["a"]);var O=[{path:"/",name:"Home",component:j},{path:"/game/:id",name:"Game",component:function(){return n.e("chunk-80cb6d7c").then(n.bind(null,"7d36"))}}],_=new f["a"]({routes:O}),S=_;n("7db0"),n("159b"),n("1276");o["a"].use(b["a"]);var C=new b["a"].Store({strict:!0,state:{store:{},pickedDiceId:null,selectedDiceSideId:null,availablePorts:[],helperLinksBounds:{},shownCard:null},getters:{isMobile:function(e){return e.isMobile},guiScale:function(e){return e.guiScale},isLandscape:function(e){return e.isLandscape},currentUser:function(e){return e.currentUser},sessionPlayerId:function(e){return e.sessionPlayerId},sessionPlayerIsActive:function(e){var t;return e.sessionPlayerId===Object.keys(((null===(t=e.store.game)||void 0===t?void 0:t[e.gameId])||{}).playerMap||{}).find((function(t){var n,a;return null===(n=e.store.player)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.active}))},currentRound:function(e){var t;return((null===(t=e.store.game)||void 0===t?void 0:t[e.gameId])||{}).round},actionsDisabled:function(e){var t,n,a;return null===(t=e.store.player)||void 0===t||null===(n=t[e.sessionPlayerId])||void 0===n||null===(a=n.eventData)||void 0===a?void 0:a.actionsDisabled},pickedDiceId:function(e){return e.pickedDiceId},selectedDiceSideId:function(e){return e.selectedDiceSideId},availablePorts:function(e){return e.availablePorts},helperLinksBounds:function(e){return e.helperLinksBounds},shownCard:function(e){return e.shownCard},getSimple:function(e){return function(t,n){var a;return(n?null===(a=e[n])||void 0===a?void 0:a[t]:e[t])||{}}},getStore:function(e){return function(t,n){var a;return(n?null===(a=e.store[n])||void 0===a?void 0:a[t]:e.store[t])||{}}},getClone:function(e){return function(t,n){var a;return JSON.parse(JSON.stringify((n?null===(a=e[n])||void 0===a?void 0:a[t]:e[t])||{}))}},getState:function(e){return e},gamePlaneCustomStyleData:function(e){return e.gamePlaneCustomStyleData||{}},getHelperLinks:function(e,t){var n=t.getStore(t.currentUser,"user").helperLinks||{},r=localStorage.getItem("currentGame");return Object.fromEntries(Object.entries(n).filter((function(e){var t=Object(a["a"])(e,2),n=(t[0],t[1]);return!0!==n.used&&n.type===(r?"game":"lobby")})))}},mutations:{setPickedDiceId:function(e,t){e.pickedDiceId=t},setSelectedDiceSideId:function(e,t){e.selectedDiceSideId=t},hideZonesAvailability:function(e){Object.keys(e.store.zone).forEach((function(t){e.store.zone[t].available&&(e.store.zone[t].available=!1)}))},setAvailablePorts:function(e,t){e.availablePorts=t},setShownCard:function(e,t){e.shownCard=t},clearData:function(e){o["a"].set(e,"forms",{}),o["a"].set(e,"session",{}),o["a"].set(e,"game",{}),console.log("clearData end")},setSimple:function(e,t){Object.entries(t).forEach((function(t){var n=Object(a["a"])(t,2),r=n[0],i=n[1];o["a"].set(e,r,i)}))},setData:function(e,t){Object.entries(t).forEach((function(t){var n=Object(a["a"])(t,2),r=n[0],i=n[1];e[r]||o["a"].set(e,r,{}),Object.keys(i).forEach((function(t){o["a"].set(e[r],t,i[t])}))}))},setDeep:function(e,t){Object.entries(t).forEach((function(t){var n=Object(a["a"])(t,2),r=n[0],i=n[1];e[r]||o["a"].set(e,r,{}),Object.keys(i).forEach((function(t){Object.entries(i[t]).forEach((function(n){var i=Object(a["a"])(n,2),s=i[0],c=i[1],u=s.split(".");e[r][t]||o["a"].set(e[r],t,{});for(var l=e[r][t],d=0;d<u.length-1;d++)l[u[d]]||o["a"].set(l,u[d],{}),l=l[u[d]];o["a"].set(l,u[u.length-1],c)}))}))}))},setStore:function(e,t){var n=e.store;Object.entries(t).forEach((function(e){var t=Object(a["a"])(e,2),r=t[0],i=t[1];n[r]||(n[r]={}),Object.keys(i).forEach((function(e){Object.entries(i[e]).forEach((function(t){var i=Object(a["a"])(t,2),s=i[0],c=i[1],u=s.split(".");n[r][e]||(n[r][e]={});for(var l=n[r][e],d=0;d<u.length-1;d++)l[u[d]]||o["a"].set(l,u[d],{}),l=l[u[d]];o["a"].set(l,u[u.length-1],c)}))}))})),o["a"].set(e,"store",Object(m["a"])({},n))}},actions:{setSimple:function(e){var t=arguments;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.state,a=e.commit,e.dispatch,r=t.length>1&&void 0!==t[1]?t[1]:{},a("setSimple",r);case 3:case"end":return n.stop()}}),n)})))()},setData:function(e){var t=arguments;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.state,a=e.commit,e.dispatch,r=t.length>1&&void 0!==t[1]?t[1]:{},a("setData",r);case 3:case"end":return n.stop()}}),n)})))()},setDeep:function(e){var t=arguments;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.state,a=e.commit,e.dispatch,r=t.length>1&&void 0!==t[1]?t[1]:{},a("setDeep",r);case 3:case"end":return n.stop()}}),n)})))()},setStore:function(e){var t=arguments;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.state,a=e.commit,e.dispatch,r=t.length>1&&void 0!==t[1]?t[1]:{},a("setStore",r);case 3:case"end":return n.stop()}}),n)})))()}},modules:{}}),M=n("be33"),I=n("ad3d"),R=n("11ca"),L=n("2753"),P=n("4ab5"),D=n("ade3"),G=n("bee2"),T=n("d4ec"),E=n("262e"),B=n("2caf"),A=n("9072"),N=(n("6062"),n("4ec9"),n("caad"),n("2532"),n("2ca0"),function(){function e(){Object(T["a"])(this,e),this.events=new Map}return Object(G["a"])(e,[{key:"on",value:function(e,t){var n=this.events.get(e);n?n.add(t):this.events.set(e,new Set([t]))}},{key:"emit",value:function(e){var t=this.events.get(e);if(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o,s=Object(r["a"])(t.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;c.apply(void 0,a)}}catch(u){s.e(u)}finally{s.f()}}}},{key:"remove",value:function(e,t){var n=this.events.get(e);n&&n.has(t)&&n.delete(t)}},{key:"clear",value:function(e){e?this.events.delete(e):this.events.clear()}}]),e}()),z=7e3,U=6e4,H=2e3,q=new Set;window.addEventListener("online",(function(){var e,t=Object(r["a"])(q);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.connected||n.open()}}catch(a){t.e(a)}finally{t.f()}}));var W=function(e){Object(E["a"])(n,e);var t=Object(B["a"])(n);function n(e){var a,r=e.message,i=e.code;return Object(T["a"])(this,n),a=t.call(this,r),a.code=i,a}return n}(Object(A["a"])(Error)),$=function(){function e(){Object(T["a"])(this,e),this._events=new Map}return Object(G["a"])(e,[{key:"on",value:function(e,t){var n=this._events.get(e);n?n.add(t):this._events.set(e,new Set([t]))}},{key:"emit",value:function(e){var t=this._events.get(e);if(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];var o,s=Object(r["a"])(t.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;c.apply(void 0,a)}}catch(u){s.e(u)}finally{s.f()}}}}]),e}(),J=function(e){Object(E["a"])(n,e);var t=Object(B["a"])(n);function n(e){var a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(T["a"])(this,n),a=t.call(this),a.url=e,a.socket=null,a.api={},a.callId=0,a.calls=new Map,a.streams=new Map,a.active=!1,a.connected=!1,a.lastActivity=(new Date).getTime(),a.callTimeout=r.callTimeout||z,a.pingInterval=r.pingInterval||U,a.reconnectTimeout=r.reconnectTimeout||H,a.open(),a}return Object(G["a"])(n,[{key:"message",value:function(e){if("{}"!==e){var t;this.lastActivity=(new Date).getTime();try{t=JSON.parse(e)}catch(_){return}var n=Object.keys(t),r=Object(a["a"])(n,2),i=r[0],o=r[1],s=t[i],c=t[o];if(s&&c){if("callback"===i){var u=this.calls.get(s);if(!u)return;var l=Object(a["a"])(u,2),d=l[0],p=l[1];return t.error?void p(new W(t.error)):"err"===t.result.status?void p(t.result):void d(c)}if("event"===i){var f=o.split("/"),v=Object(a["a"])(f,2),h=v[0],m=v[1],b=this.api[h];b.emit(m,c)}if("stream"===i){var g=t,w=g.name,k=g.size,y=g.status;if(w){var x={name:w,size:k,chunks:[],received:0};return void this.streams.set(s,x)}var j=this.streams.get(s);if(y){this.streams.delete(s);var O=new Blob(j.chunks);return void O.text().then((function(e){console.log({text:e})}))}}}}}},{key:"load",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,i,o,s,c,u,l,d,p,f,v,h,m,b=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=this.scaffold("system")("introspect"),n=b.length,a=new Array(n),r=0;r<n;r++)a[r]=b[r];return e.next=4,t(a);case 4:i=e.sent,o=Object.keys(i),s=0,c=a;case 7:if(!(s<c.length)){e.next=20;break}if(u=c[s],o.includes(u)){e.next=11;break}return e.abrupt("continue",17);case 11:for(l=new $,d=i[u],p=this.scaffold(u),f=Object.keys(d),v=0,h=f;v<h.length;v++)m=h[v],l[m]=p(m);this.api[u]=l;case 17:s++,e.next=7;break;case 20:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"scaffold",value:function(e,t){var n=this;return function(a){return Object(i["a"])(regeneratorRuntime.mark((function r(){var i,o,s,c,u=arguments;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(i=u.length>0&&void 0!==u[0]?u[0]:{},o=++n.callId,s=t?"".concat(e,".").concat(t):e,c=s+"/"+a,n.connected){r.next=7;break}return r.next=7,n.open();case 7:return r.abrupt("return",new Promise((function(e,t){setTimeout((function(){n.calls.has(o)&&(n.calls.delete(o),t(new Error("Request timeout")))}),n.callTimeout),n.calls.set(o,[e,t]);var a=Object(D["a"])({call:o},c,i);n.send(JSON.stringify(a))})));case 8:case"end":return r.stop()}}),r)})))}}}],[{key:"create",value:function(e,t){var a=n.transport,r=e.startsWith("ws")?a.ws:a.http;return new r(e,t)}}]),n}(N),F=function(e){Object(E["a"])(n,e);var t=Object(B["a"])(n);function n(){return Object(T["a"])(this,n),t.apply(this,arguments)}return Object(G["a"])(n,[{key:"open",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.connected){e.next=2;break}return e.abrupt("return");case 2:return t=new WebSocket(this.url),this.active=!0,this.socket=t,q.add(this),t.addEventListener("message",(function(e){var t=e.data;"string"!==typeof t||n.message(t)})),t.addEventListener("close",(function(){n.connected=!1,setTimeout((function(){n.active&&n.open()}),n.reconnectTimeout)})),t.addEventListener("error",(function(e){n.emit("error",e),t.close()})),setInterval((function(){if(n.active){var e=(new Date).getTime()-n.lastActivity;e>n.pingInterval&&n.send("{}")}}),this.pingInterval),e.abrupt("return",new Promise((function(e){t.addEventListener("open",(function(){n.connected=!0,e()}))})));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"close",value:function(){this.active=!1,q.delete(this),this.socket&&(this.socket.close(),this.socket=null)}},{key:"send",value:function(e){this.connected&&(this.lastActivity=(new Date).getTime(),this.socket.send(e))}}]),n}(J),K=function(e){Object(E["a"])(n,e);var t=Object(B["a"])(n);function n(){return Object(T["a"])(this,n),t.apply(this,arguments)}return Object(G["a"])(n,[{key:"open",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.active=!0,this.connected=!0;case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"close",value:function(){this.active=!1,this.connected=!1}},{key:"send",value:function(e){var t=this;this.lastActivity=(new Date).getTime(),fetch(this.url,{method:"POST",headers:{"Content-Type":"application/json"},body:e}).then((function(e){var n=e.status;if(200===n)return e.text().then((function(e){if(e.error)throw new W(e.error);t.message(e)}));throw new Error("Status Code: ".concat(n))}))}}]),n}(J);J.transport={ws:F,http:K},M["c"].add(R["a"],L["a"],P["a"]),o["a"].component("font-awesome-icon",I["a"]),o["a"].config.productionTip=!1,window.vuex=C;var V=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n,s,c,u,l,d,f,v,h,m,b;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t="http:"===location.protocol?"ws":"wss",n="localhost"===location.hostname?"localhost:8800":"".concat(location.hostname,"/api"),s=J.create("".concat(t,"://").concat(n)),c=s.api,window.api=c,e.next=7,s.load("auth","example","db","chat","session","lobby","game","helper","subscribe");case 7:return localStorage.removeItem("currentGame"),u=localStorage.getItem("metarhia.session.token"),e.next=11,c.auth.initSession({token:u,demo:!0});case 11:l=e.sent,d=l.token,f=l.userId,u!==d&&localStorage.setItem("metarhia.session.token",d),f&&C.dispatch("setSimple",{currentUser:f}),S.beforeEach((function(e,t,n){var a=localStorage.getItem("currentGame");if("Game"===e.name){if(!a)return n({name:"Home"})}else if(a)return n({name:"Game",params:{id:a}});return n()})),window.app=new o["a"]({router:S,store:C,render:function(e){return e(p)}}).$mount("#app"),v=navigator,h=v.userAgent,m=function(){return h.match(/Android/i)||h.match(/webOS/i)||h.match(/iPhone/i)||h.match(/iPad/i)||h.match(/iPod/i)||h.match(/BlackBerry/i)||h.match(/Windows Phone/i)},b=function(){var e=window.innerWidth,t=window.innerHeight;C.dispatch("setSimple",{isMobile:!!m(),isLandscape:t<e,guiScale:e<1e3?1:e<1500?2:e<2e3?3:e<3e3?4:5})},window.addEventListener("resize",b),b(),c.db.on("updated",(function(e){C.dispatch("setData",e)})),c.db.on("smartUpdated",(function(e){C.dispatch("setStore",e)})),c.session.on("joinGame",(function(e){localStorage.setItem("currentGame",e.gameId),C.dispatch("setSimple",{sessionPlayerId:e.playerId}),S.push({path:"/game/".concat(e.gameId)})})),c.session.on("leaveGame",(function(){localStorage.removeItem("currentGame"),S.push({path:"/"})})),document.addEventListener("click",function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.target.classList.contains("active-event")){e.next=3;break}return e.next=3,c.game.action({name:"eventTrigger",data:{eventData:{targetId:null===(n=t.target.attributes.id)||void 0===n?void 0:n.value}}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),new MutationObserver((function(e,t){var n,i=Object(r["a"])(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if("childList"===o.type);else if("attributes"===o.type&&(o.attributeName,"markup-onload"===o.attributeName)){var s=o.target.getAttribute("markup-onload");window[s]&&window[s](o.target)}}}catch(c){i.e(c)}finally{i.f()}C.dispatch("setSimple",{helperLinksBounds:Object.fromEntries(Object.entries(C.getters.getHelperLinks).map((function(e){var t,n=Object(a["a"])(e,2),r=n[0],i=n[1];return[r,(null===(t=window.app.$el.querySelector(i.selector))||void 0===t?void 0:t.getBoundingClientRect())||null]})))})})).observe(document.querySelector("body"),{attributes:!0,childList:!0,subtree:!0,attributeOldValue:!0});case 28:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();V()},"5c0b":function(e,t,n){"use strict";n("9c0c")},"9c0c":function(e,t,n){},"9e6d":function(e,t,n){e.exports=n.p+"img/lobby.5e9da46d.png"}});
//# sourceMappingURL=app.78dbc4c4.js.map